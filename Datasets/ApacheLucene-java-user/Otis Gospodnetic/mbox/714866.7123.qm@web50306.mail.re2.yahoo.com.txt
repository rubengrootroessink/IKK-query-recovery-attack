FROM: Otis Gospodnetic <otis_gospodne...@yahoo.com>
SUBJECT: Re: Memory leak (JVM 1.6 only)
DATE: 18 May 2007

Hi Steve,

You said the OOM happens only when you are indexing.  You don't need LuceneIndexAccess for
that, so get rid of that to avoid one suspect that is not part of Lucene core.  What is your
maxBufferedDocs set to?  And since you are using JVM 1.6, check out jmap, jconsole & friends,
they'll provide insight into where your OOM is coming from.  I see your app is a webapp. 
How do you know it's Lucene and its indexing that are the source of OOM and not something
else, such as a bug in Tomcat?

Otis
 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
Simpy -- http://www.simpy.com/  -  Tag  -  Search  -  Share

----- Original Message ----
From: Stephen Gray <Stephen.Gray@anu.edu.au>
To: java-user@lucene.apache.org
Sent: Tuesday, May 15, 2007 2:31:05 AM
Subject: Memory leak (JVM 1.6 only)

Hi everyone,

I have an application that indexes/searches xml documents using Lucene. 
I'm having a problem with what looks like a memory leak, which occurs 
when indexing a large number of documents, but only when the application 
is running under JVM 1.6. Under JVM 1.5 there is no problem. What 
happens is that the memory allocated consistently rises during indexing 
until the JVM crashes with an OutOfMemory exception.

I'm using Lucene 2.1, and am using Maik Schreiber's LuceneIndexAccess 
API, which hands out references to cached IndexWriter/Reader/Searchers 
to objects that need to use them, and handles closing and re-opening 
IndexSearchers after documents are added to the index. The application 
is running under Tomcat 6.

I'm a bit out of my depth determining the source of the leak - I've 
tried using Netbeans profiler, which shows a large number of HashMap 
instances that survive a long time, but these are created by many 
different classes so it's difficult to pinpoint one source.

Has anyone found similar problems with Lucene indexing operations 
running under JVM 1.6? Does anyone have any suggestions re how to deal 
with this?

Any help much appreciated.

Thanks,
Steve

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org





---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


