FROM: petite_abeille <petite_abei...@mac.com>
SUBJECT: Re: read past EOF?
DATE: 8 Jan 2003


On Tuesday, Jan 7, 2003, at 22:46 Europe/Zurich, Doug Cutting wrote:

> It looks like the .fdx and one of the .f[0-9]* files are out of sync. 
> The .fdx file for each segment should be exactly eight times as long 
> as all of the .f[0-9] files for that segment.
>
> This could happen if Lucene's file locking is disabled or broken.

I see.

>   What version of Lucene are you using?

lucene-20020628.jar

>  What JVM?

Java HotSpotâ„¢ Client VM 1.3.1
English (United States)
Apple Computer, Inc.

Mac OS X 10.2.3
PPC

>   File locking is known to be broken over NFS, and wasn't even present 
> in early versions of Lucene. Are you using an ordinary FSDirectory to 
> store your index?

Yes. Regular local HFS+ file system.

>
> The scenario I can see that this would happen in is if two processes 
> or threads are permitted to modify an index at once.  If one were 
> optimizing and one were just adding a single document, then the same 
> segment name would be allocated to both, but one would write a much 
> larger segment.  If their operations were interleaved then some of the 
> segment's files would be written by one of them, and some by the 
> other, resulting in the sort of inconsistency you're seeing.
>
> You might start logging the start and end time of document additions 
> and index optimizations, to see if this sort of thing is happening...

Thanks. I will dig deeper in it.

PA.


--
To unsubscribe, e-mail:   <mailto:lucene-user-unsubscribe@jakarta.apache.org>
For additional commands, e-mail: <mailto:lucene-user-help@jakarta.apache.org>


