FROM: "Praveen Peddi" <ppe...@contextmedia.com>
SUBJECT: Re: Best way to find if a document exists, using Reader ...
DATE: 14 Jan 2005

Thanks Morus,
Silly me. I should have seen the source code before asking the question. I 
usually do that but for some reason I didn't do it this time.

Looking at the source code, you are right. It doesn't make sense to do that. 
But Is there such a performance over head on termDocs().

I tested as follows:
1) Adding 250K documents took half an hour for lucene.
2) Deleting and adding same 250K documents took more than 50 minutes. In my 
test all 250K objects are new so there is nothing to delete.

Looks like there is no other way to make it fast.

Praveen
----- Original Message ----- 
From: "Morus Walter" <morus.walter@tanto.de>
To: "Lucene Users List" <lucene-user@jakarta.apache.org>
Sent: Friday, January 14, 2005 8:37 AM
Subject: Re: Best way to find if a document exists, using Reader ...


> Praveen Peddi writes:
>>
>> Does it makes sense to call docFreq or termDocs (which ever is faster) 
>> before calling delete?
>>
> IMO no.
>
> calling termDocs is what Reader.delete(Term) does:
>
>  public final int delete(Term term) throws IOException {
>    TermDocs docs = termDocs(term);
>    if (docs == null) return 0;
>    int n = 0;
>    try {
>      while (docs.next()) {
>        delete(docs.doc());
>        n++;
>      }
>    } finally {
>      docs.close();
>    }
>    return n;
>  }
>
> (the advantage of OSS is, that you can look into it's sources)
>
> So it already uses termDocs to see if there's anything to do.
> I doubt that using docFreq would be much faster. In both cases the
> term is searched and -- if you don't have to delete anything -- not
> found. If it's found, docFreq might be faster, but in that case you have
> to delete and use termDocs anyway.
>
> Morus
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: lucene-user-unsubscribe@jakarta.apache.org
> For additional commands, e-mail: lucene-user-help@jakarta.apache.org
>
> 


---------------------------------------------------------------------
To unsubscribe, e-mail: lucene-user-unsubscribe@jakarta.apache.org
For additional commands, e-mail: lucene-user-help@jakarta.apache.org


