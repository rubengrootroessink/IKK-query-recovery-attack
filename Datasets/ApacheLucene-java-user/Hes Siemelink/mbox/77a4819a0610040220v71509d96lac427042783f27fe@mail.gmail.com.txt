FROM: "Hes Siemelink" <hesn...@gmail.com>
SUBJECT: Sudden FileNotFoundException
DATE: 4 Oct 2006

Hi all

I'm having trouble with FileNotFoundException that pops up every once and a
while. Everything works fine in my application (description below), but
after running for some time (eg. 20 hours) an exception like this one may
occur:

java.io.FileNotFoundException: /lucene-indexes/mediafragments/_8km.fnm (No
such file or directory)
    at java.io.RandomAccessFile.open(Native Method)
    at java.io.RandomAccessFile.<init>(RandomAccessFile.java:212)
    at org.apache.lucene.store.FSIndexInput$Descriptor.<init>(
FSDirectory.java:430)
    at org.apache.lucene.store.FSIndexInput.<init>(FSDirectory.java:439)
    at org.apache.lucene.store.FSDirectory.openInput(FSDirectory.java:329)
    at org.apache.lucene.index.FieldInfos.<init>(FieldInfos.java:56)
    at org.apache.lucene.index.SegmentReader.initialize(SegmentReader.java
:144)
    at org.apache.lucene.index.SegmentReader.get(SegmentReader.java:129)
    at org.apache.lucene.index.SegmentReader.get(SegmentReader.java:110)
    at org.apache.lucene.index.IndexReader$1.doBody(IndexReader.java:152)
    at org.apache.lucene.store.Lock$With.run(Lock.java:99)
    at org.apache.lucene.index.IndexReader.open(IndexReader.java:141)
    at org.apache.lucene.index.IndexReader.open(IndexReader.java:125)

The rest of my log files is filled with the same exception:
FileNotFoundException for _8km.fnm.

It smells like a rotten index. But I have no clue about how the index got
corrupted...

The application is a web-application, with several indexes. Each index has
update thread that manages the writer. There are continuous updates to the
index. Simultaneously, there may be various user threads doing searches.

This particular index is about 30Mb. I can't tell how many segments there
were when the exceptions occured.

This exception occurs, as for as I can tall, some time after the last update
and during a search query of one active user.

I am using Lucene 2.0.0 and the server is running on Tomcat 5.5 on Linux
Redhat Enterprise 3, with jdk 1.5.0_07.

I am at loss at where to look for the problem. Is it Lucene? Is it my
handling of the Lucene API? Is it the implemenation of the File Lock in
combination with OS/JVM?

The only way to reproduce the problem is to have the production server run
for a day or so... not exactly ideal.

Any help is greatly appreciated!

    Hes Siemelink
    Finalist IT Group

