FROM: "Mark Modrall" <MModr...@glgroup.com>
SUBJECT: RE: running a lucene indexing app as a windows service on xp, crashing
DATE: 7 Aug 2006

Hi Mike...

	Sorry I didn't respond over the weekend; I wasn't checking work
email.

	A few more pieces of information about our circumstances:  the
indexing system is running Windows Server 2003 sp1, the directories that
the indexer is using are shares (helped reproduce; we had a couple of
people using explorer to watch the directory), the corpus being indexed
at the time had something like 190K rows and indexing took about 1.42
hours (so plenty of time to try).  Another person here suggested the
fact that our explorer windows were set to "Details" might be relevant
since explorer needs to touch each file to get the details.

	When we had 2 users hitting refresh on the window as frequently
as they could, the crash took only about 3 minutes to reproduce.

	The traceback we saw was in the fallback code (when renameTo
didn't work) on the line opening the new output file (which didn't
exist).  That made me wonder if the problem wasn't with the single
destination file but with access to the root directory.  The indexer
cranks out scads of those little temp files; if Explorer is in the
middle of a details refresh, maybe it has some kind of lock on directory
modification and a long list would increase the chance that the java
code may be trying that code at the same time.

	I'll ask the guy who's running the indexer if he'd be open to
trying the patch.

Thanks
_mark




 
This e-mail message, and any attachments, is intended only for the use of the individual or
entity identified in the alias address of this message and may contain information that is
confidential, privileged and subject to legal restrictions and penalties regarding its unauthorized
disclosure and use. Any unauthorized review, copying, disclosure, use or distribution is strictly
prohibited. If you have received this e-mail message in error, please notify the sender immediately
by reply e-mail and delete this message, and any attachments, from your system. Thank you.


-----Original Message-----

From: Michael McCandless [mailto:lucene@mikemccandless.com] 
Sent: Saturday, August 05, 2006 4:34 PM
To: java-user@lucene.apache.org
Subject: Re: running a lucene indexing app as a windows service on xp,
crashing


> This is windows/jvm issue . Have a look at how ant is dealing with it,
maybe we could give it a try with something like that (I have not
noticed ant having problems).

Indeed it seems like Windows somehow believes the "deletable" file must 
be still held open, given that the File.renameTo and also the "fallback"

open failed.

I tried a quick test to reproduce this but could not.  I just modified 
the demo IndexFiles command line tool to add documents forever, then 
used Windows Explorer to refresh like crazy...  I tested with Sun JDK 
1.4.2 on Windows XP Pro SP 2.

Which JDK / version, and Windows XP version, are you using?

Mike


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


