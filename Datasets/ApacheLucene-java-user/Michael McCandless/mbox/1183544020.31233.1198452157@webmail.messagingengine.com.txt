FROM: "Michael McCandless" <luc...@mikemccandless.com>
SUBJECT: Re: Lucene 2.2, NFS, Lock obtain timed out
DATE: 4 Jul 2007


"Patrick Kimber" <mailing.patrick.kimber@gmail.com> wrote:

> Yes, there are many lines in the logs saying:
> hit FileNotFoundException when loading commit "segment_X"; skipping
> this commit point
> ...so it looks like the new code is working perfectly.

Super!

> I am sorry to be vague... but how do I check which segments file is
> opened when a new writer is created?

Oh, sorry, it's not exactly obvious.  Here's what to look for:

On machine #1 (the machine that added docs & then closed its writer)
you should see lines like this, which are printed every time the
writer flushes its docs:

    checkpoint: wrote segments file "segments_X"

Find the last such line on machine #1 before it closes the writer, and
that's the "current" segments_X in the index.

Then on machine #2 (the machine that immediately opens a new writer
after machine #1 closed its writer) you should see a line like this:

    org.apache.lucene.index.IndexFileDeleter@XXXXXXX main: init: current segments file is
"segments_Y"

which indicates which segments file was loaded by this writer.  The
thing to verify is that X is always equal to Y whenever a writer
quickly moves from machine #1 to machine #2.

> I will add a check to my test to see if all documents are added.  This
> should tell us if any documents are being silently lost.

Very good!  Keep us posted, and good luck,

Mike

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


