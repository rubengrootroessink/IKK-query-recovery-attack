FROM: Michael McCandless <luc...@mikemccandless.com>
SUBJECT: Re: read past EOF
DATE: 1 Sep 2006


> Yes I am sure only one writer at a time accessing index.
> 
> no i am not getting any other exception.
> 
> and there is no problem of disk space also.
> 
> right now i have backcopy of indexes so whenever one index got corrupted 
> i m replacing with backup one and starting the indexer again from that 
> duration.
> 
> Here is the script which i am using to move index after its built.
> 
> - rm -rf backupindex/*
> - mv index backupindex;
> - mv newindex index;
> - mkdir newindex
> - cp -dpR index/* newindex/
> - touch index.done
> - echo "done";
> 
> where "newindex" is the index which I am using for indexing...."index" 
> which i am using for search purpose....and "backupindex" contains 
> previous index.

It sounds like you're working with the index correctly, so I don't have 
any other ideas on why you're getting CFS files that are truncated.  I 
would wory about the "cp" step filling up disk, but if you're nowhere 
near filling up disk that's not the root cause here.

Does this happen intermittantly?  Or it happened once and now it's gone? 
  Or is it easy to reproduce?

> Is there any way through which  I can check if index is corrupt or 
> not....right now because of this exception (read past EOF ) i made few 
> changes in my code to check for corrupt index. But i am checking for 
> corrupt index through optimizing...If in optimization of index i m 
> getting IOException I am considering that index got corrupted or there 
> is permission issue..

That's a great question.  I don't know of existing tools for doing this 
(anyone else?).  Running optimize is likely a good test, so long as 
there's more than 1 segment before optimize (so that it actually does 
something).

Mike

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


