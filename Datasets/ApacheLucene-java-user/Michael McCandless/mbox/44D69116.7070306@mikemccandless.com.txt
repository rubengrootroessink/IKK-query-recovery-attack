FROM: Michael McCandless <luc...@mikemccandless.com>
SUBJECT: Re: running a lucene indexing app as a windows service on xp, crashing
DATE: 7 Aug 2006


> XP Proffesionall / win 2003 Server, we had this issue on JVMs 1.5/1.6.
> 
> It seams it this happens "not so often" on 1.6/Win2003, but we have this in production
only for 2 weeks.
> 
> We have single update machine that builds index in batch and replicates to many Index
readers, so at least customers are not affected by this annoyance, they get their updates
only a few hours later ...

Have you also noticed that opening Windows explorer to the index output 
directory causes this error?  Are you seeing that same traceback as the 
original poster (Mark)?

> Anyhow, I would be really interested to have this problem solved somehow, my logic was
if ant never had this problem (not that I know), let us try their approach.  What is annoyance
for me personally is that I am not able to reproduce this problem reliably enough... happens
only in production once in a month (daily updates, ca 40Mio documents)
> 
> What Store you use, MMAP or FS? IndexWriter cannot function with MMAP on our machines
(yet another WIN problem), Reader works like a charm 

I'm just testing with FSDirectory right now.  I also tested on Sun JDK 1.5:

   Java(TM) 2 Runtime Environment, Standard Edition (build 1.5.0_07-b03)

and refreshed the directory in Windows Explorer constantly, but no 
Access Denied exceptions.  I'm just running with this diff on the demo 
IndexFiles.java:

===================================================================
--- src/demo/org/apache/lucene/demo/IndexFiles.java	(revision 425202)
+++ src/demo/org/apache/lucene/demo/IndexFiles.java	(working copy)
@@ -54,7 +54,9 @@
      try {
        IndexWriter writer = new IndexWriter(INDEX_DIR, new 
StandardAnalyzer(), true);
        System.out.println("Indexing to directory '" +INDEX_DIR+ "'...");
-      indexDocs(writer, docDir);
+      for(int i=0;i<10000;i++) {
+        indexDocs(writer, docDir);
+      }
        System.out.println("Optimizing...");
        writer.optimize();
        writer.close();

Mark could you try this modified IndexFiles.java and see if you can 
reproduce the issue on your box?  If so then I think there must be some 
environment / versioning issue that tickles this JVM issue.

> On a side note,   Latest 1.6 binaries look stable (as far as our Lucene based app is
concerned),  brings nice speed-up  for free (up to 30% on 64 bit platforms!)

Fantastic!  Progress is progress ...

Mike

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


