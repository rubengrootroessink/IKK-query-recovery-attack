FROM: Michael McCandless <luc...@mikemccandless.com>
SUBJECT: Re: Merge Index Filling up Disk Space
DATE: 26 Dec 2006

Harini Raghavan wrote:
> Yes I think I got hit IOException. I assumed that the.tmp files are not 
> required and deleted them manually from the indes directory as they were 
> more than 10G. Is that ok?

Yes, they are indeed not necessary so deleting them is fine.  This
(deleting partially created files on an Exception) is what the trunk
version of Lucene now does if it hits a disk full exception while
merging.

So I think everything here is explained now?  I will update the
javadocs with that additional caveat about open readers against the
index while optimizing.

> Michael McCandless wrote:
> 
>> Harini Raghavan wrote:
>>
>>> Thank you for the response. I don't have readers open on the index, 
>>> but while the optimize/merge was running I was searching on the 
>>> index. Would that make any difference?
>>
>>
>> You're welcome!  Right, a searcher opens an IndexReader.  So this
>> means you should see peak @ 3X the starting index size (assuming you
>> don't re-open some readers during the optimize in which case it could
>> be > 3X).
>>
>>> Also after the optimizing the index I had some .tmp files which were 
>>> > 10G and did not get merged. Could that also be related to having 
>>> searchers open while running optimize?
>>
>>
>> If you hit a disk full, then, I would expect unused .tmp files to be
>> left around.  Did you actually hit an IOException due to disk full,
>> and, is the timestamp of these .tmp files around the time it occurred?
>>
>> Note that the trunk version of Lucene has been fixed to not leave such
>> unreferenced files even on IOException, but that's not yet released.

Mike

---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


