FROM: Lucas Naz√°rio dos Santos <nazario.lu...@gmail.com>
SUBJECT: Problem doing backup using the SnapshotDeletionPolicy class
DATE: 14 Aug 2009

Hi,

I'm using the SnapshotDeletionPolicy class to backup my index. I basically
call the snapshot() method from the class SnapshotDeletionPolicy at some
point, get a list of files that changed, copy then to the backup folder, and
finish by calling the release() method.

The problem arises when, in between backups, I optimize the index by opening
it with the IndexWriter class and calling the optimize() method. When I
don't optimize in between backups, here is what happens:

The first backup copies the segment composed by the files _0.cfs and
segments_2. The second backup copies the files _1.cfs and segments_3, and
the third backup copies the files _2.cfs e segments_4. I can open the backup
folder with Luke without problems.

When I do optimize in between backups, the copies are as follow:

The first backup copies the segment composed by the files _0.cfs and
segments_2. The second backup copies the files _1.cfs and segments_3, and
the third backup copies the files _3.cfs e segments_5. In this case, when I
try to open the backup folder, Luke gives a message saying that it can't
find the file _2.cfs.

My question is: how can I backup my index using the SnapshotDeletionPolicy
and having to optimize the index in between backups? Am I using the right
backup strategy?

Thanks,
Lucas

