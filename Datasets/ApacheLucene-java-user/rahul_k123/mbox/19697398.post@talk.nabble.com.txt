FROM: rahul_k123 <vishnudee...@gmail.com>
SUBJECT: Re: Caused by: java.io.IOException: read past EOF on Slave
DATE: 26 Sep 2008


I will try the other stuff and will let you know.

This is how we do the search ,

we will get the Hits in one call and we will make another call to get the
data from lucene.

My guess is when it gets the matching Hits it getting from master and when
it tries to retrieve the actual data its hitting the slave where it doesn't
have the updated data yet .

I will test this scenario and will let you know.

Some answers below too



Michael McCandless-2 wrote:
> 
> 
> Which version of Lucene is this?  Looks like 2.3.x -- what's the x?   
> 
> 2.3.1
> 
> Can you run your app server with assertions enabled for  
> org.apache.lucene.*?  It may catch something sooner.
> 
> 
> Can you try running CheckIndex after the snapshot is produced, just to  
> see if there is any corruption?
> 
> Your first exception (on the slave) seems like the *.fdx file of that  
> one segment is somehow truncated, or, you are passing an out-of-bounds  
> document number to IndexReader.document.
> 
> Your 2nd one (on the master) looks like an invalid (deleted) document  
> number is being passed to IndexReader.document.
> 
> What is the context of these IndexReader.document(...) calls?  How are  
> you getting the doc numbers that you're passing to them?  In both  
> cases, an invalid doc number would explain your exception.  Are you  
> doing any search caching, where you cache hits and then much later try  
> to load the documents for each hit, or, something?
> 
> More questions below...
> 
> rahul_k123 wrote:
> 
>>
>> The following are steps..
>>
>> 1.We do indexing every 5 minutes on master and when indexing is done a
>> snapshot is taken
> 
> The IndexWriter is definitely closed before the snapshot is taken?
> 
> Are you creating a new index, or, just adding to an existing one?  Adding
> to the existing one
> 
>> 2. On slave we have a cronjob which runs snappuller every 3 minutes  
>> to check
>> for new snapshots and installs it on slave if it finds new one
> 
> Sounds OK.  Does this entail a restart of the reader after the  
> snapshot is installed?   yes, before using reading we check
> indexreader.iscurrent()
> 
>> (I am not using SOLR for indexing )
>>
>>
>> The file system is ext3
> 
> OK.
> 
> Mike
> 
> 
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
> For additional commands, e-mail: java-user-help@lucene.apache.org
> 
> 
> 

-- 
View this message in context: http://www.nabble.com/Caused-by%3A-java.io.IOException%3A-read-past-EOF-on-Slave-tp19682684p19697398.html
Sent from the Lucene - Java Users mailing list archive at Nabble.com.


---------------------------------------------------------------------
To unsubscribe, e-mail: java-user-unsubscribe@lucene.apache.org
For additional commands, e-mail: java-user-help@lucene.apache.org


